<template>
  <v-card flat :style="`height:${getHeight}px`">
    <v-card-text :style="{ height: 'calc(100% - 36px)', overflow: 'auto' }">
      <!-- Aggiungere nuova scheda dati generali -->
      <!-- <v-btn rounded color="primary" dark small @click="aggiungiArticoloClick" class="ma-2"> aggiungi articolo <v-icon>mdi-plus</v-icon> </v-btn> -->

      <!-- Elenco schede giÃ  compilate -->
      <div v-if="record.listaArticoliGen && record.listaArticoliGen.length > 0">
        <v-expansion-panels focusable>
          <v-expansion-panel v-for="(artGen, i) in record.listaArticoliGen" :key="i">
            <v-expansion-panel-header>
              <v-row class="py-0" no-gutters>
                <v-col cols="12" class="py-0">
                  <v-input :hint="artGen.subDescrizione" dense persistent-hint :hide-details="artGen.subDescrizione == ''">
                    {{ artGen.descrizione }}
                  </v-input>
                </v-col>
              </v-row>
            </v-expansion-panel-header>
            <v-expansion-panel-content class="pt-2">
              <div v-for="(prop, j) in artGen.listaPropValued" :key="j">
                <p>{{ prop.propLabel }} : {{ prop.propValue || prop.propValueDecode }}</p>
              </div>

              <v-card-actions class="pa-0">
                <v-spacer></v-spacer>
                <v-btn text small @click="editArtGen(artGen._id)"><v-icon>mdi-pencil</v-icon>Modifica</v-btn>
                <v-btn text small @click="deleteArtGen(artGen._id)"><v-icon>mdi-trash-can-outline </v-icon>Elimina</v-btn>
              </v-card-actions>
            </v-expansion-panel-content>
          </v-expansion-panel>
        </v-expansion-panels>
      </div>

      <v-container v-else class="fill-height d-flex flex-column align-center justify-center">
        <v-img :src="require('../../assets/images/schede-empty-list.png')" contain max-width="50%" max-height="50%"></v-img>
        <p class="title text-center">Non sono state aggiunte chede</p>
        <p class="caption font-weight-light text-center" style="margin-top: -20px;">
          Usa il pulsante qui in basso per aggiungerne
        </p>
      </v-container>
    </v-card-text>
    <v-card-actions class="py-0 d-flex justify-center">
      <v-btn width="50%" text outlined color="indigo" @click="aggiungiArticoloClick"><v-icon>mdi-plus</v-icon> AGGIUNGI SCHEDA</v-btn>
      <v-btn width="50%" text outlined color="indigo" @click="apriWizardRilievo" v-if="record.listaArticoliGen && record.listaArticoliGen.length > 0"
        ><v-icon>mdi-tape-measure</v-icon>INIZIA RILIEVO</v-btn
      >
    </v-card-actions>
  </v-card>
</template>


<script lang="ts">
import { Vue, Component, namespace, State, Getter } from 'nuxt-property-decorator'
import { RilievoRecord, RilievoUI } from '@/store/rilievoModule'

@Component({ components: {}, name: 'schede' })
export default class RilievoSchede extends Vue {
  @State(state => state.rilievoModule.record) record!: RilievoRecord
  @State(state => state.rilievoModule.ui) ui!: RilievoUI

  aggiungiArticoloClick() {
    this.ui.visualizzaWizardSchede = true
  }

  apriWizardRilievo() {
    this.ui.visualizzaWizardRilievo = true
  }

  get getHeight() {
    let offset = -10
    if (this.$vuetify.breakpoint.xsOnly) {
      return this.$vuetify.breakpoint.height - 120 //+ offset
    } else {
      return this.$vuetify.breakpoint.height - 300 //+ offset
    }
  }

  editArtGen(id: string) {}

  deleteArtGen(id: string) {}
}
</script>